# ğŸ§  EmotionWise - ê°ì • ë¶„ì„ ë° ê´€ë¦¬ ì›¹ ì„œë¹„ìŠ¤

> ë‹¹ì‹ ì˜ ê°ì •ì„ ì´í•´í•˜ê³ , ê±´ê°•í•˜ê²Œ ê´€ë¦¬í•˜ëŠ” AI ê¸°ë°˜ ê°ì • ì½”ì¹­ í”Œë«í¼

## ğŸ“‹ ëª©ì°¨

- [í”„ë¡œì íŠ¸ ì†Œê°œ](#-í”„ë¡œì íŠ¸-ì†Œê°œ)
- [ì£¼ìš” ê¸°ëŠ¥](#-ì£¼ìš”-ê¸°ëŠ¥)
- [ê¸°ìˆ  ìŠ¤íƒ](#-ê¸°ìˆ -ìŠ¤íƒ)
- [ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜](#-ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜)
- [ì„¤ì¹˜ ë° ì‹¤í–‰](#-ì„¤ì¹˜-ë°-ì‹¤í–‰)
- [API ë¬¸ì„œ](#-api-ë¬¸ì„œ)
- [ê°œë°œ ê°€ì´ë“œ](#-ê°œë°œ-ê°€ì´ë“œ)
- [ë°°í¬](#-ë°°í¬)
- [ê¸°ì—¬í•˜ê¸°](#-ê¸°ì—¬í•˜ê¸°)
- [ë¼ì´ì„ ìŠ¤](#-ë¼ì´ì„ ìŠ¤)

## ğŸ¯ í”„ë¡œì íŠ¸ ì†Œê°œ

EmotionWiseëŠ” ì‚¬ìš©ìê°€ ìì‹ ì˜ ê°ì •ì„ ëª…í™•íˆ ì¸ì‹í•˜ê³  íš¨ê³¼ì ìœ¼ë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆë„ë¡ ë•ëŠ” AI ê¸°ë°˜ ê°ì • ë¶„ì„ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.

### í•µì‹¬ ê°€ì¹˜
- **ê°ì • ì¸ì‹**: ë³µì¡í•œ ê°ì • ìƒíƒœë¥¼ ëª…í™•íˆ íŒŒì•…
- **ì›ì¸ ë¶„ì„**: AIë¥¼ í†µí•œ ê°ì • ë°œìƒ ì›ì¸ ë¶„ì„
- **ë§ì¶¤í˜• ì¡°ì–¸**: ê°œì¸ë³„ ìƒí™©ì— ìµœì í™”ëœ ê°ì • ê´€ë¦¬ ë°©ë²• ì œê³µ
- **íŒ¨í„´ í•™ìŠµ**: ê°œì¸ì˜ ê°ì • íŒ¨í„´ì„ í•™ìŠµí•˜ì—¬ ì˜ˆë°©ì  ê´€ë¦¬ ì§€ì›

### íƒ€ê²Ÿ ì‚¬ìš©ì
- ê°ì • ê´€ë¦¬ì— ì–´ë ¤ì›€ì„ ê²ªëŠ” 20-40ëŒ€ ì§ì¥ì¸
- ëŒ€ì¸ê´€ê³„ ë° ì—…ë¬´ ìŠ¤íŠ¸ë ˆìŠ¤ë¡œ ì¸í•œ ê°ì • ê¸°ë³µì´ ì‹¬í•œ ì‚¬ìš©ì
- ìê¸°ê³„ë°œ ë° ì •ì‹ ê±´ê°• ê´€ë¦¬ì— ê´€ì‹¬ì´ ë†’ì€ ì‚¬ìš©ì

## âœ¨ ì£¼ìš” ê¸°ëŠ¥

### ğŸª ê°ì • ìƒí™© ì…ë ¥ ì‹œìŠ¤í…œ
- **êµ¬ì¡°í™”ëœ ìƒí™© ê¸°ë¡**: ì‹œê°„, ì¥ì†Œ, ë™ë°˜ì, ìƒí™© ìœ í˜• ì²´ê³„ì  ì…ë ¥
- **ëŒ€í™” ë‚´ìš© ë¶„ì„**: ììœ  í…ìŠ¤íŠ¸ ë° ìŒì„± ì…ë ¥ ì§€ì›
- **ê°ì • ìƒíƒœ ì¸¡ì •**: 8ê°€ì§€ ê¸°ë³¸ ê°ì • + ê°•ë„ ì¸¡ì • + ë³µí•© ê°ì • ì§€ì›

### ğŸ¤– AI ê°ì • ë¶„ì„ ì—”ì§„
- **ì‹¤ì‹œê°„ ê°ì • ë¶„ì„**: 3ì´ˆ ì´ë‚´ ë¶„ì„ ê²°ê³¼ ì œê³µ
- **ì›ì¸ íŒŒì•…**: ëŒ€í™” ë‚´ìš©ê³¼ ìƒí™© ë§¥ë½ ê¸°ë°˜ ê°ì • íŠ¸ë¦¬ê±° ì‹ë³„
- **ê°œì¸í™” í•™ìŠµ**: ê°œì¸ë³„ ê°ì • íŒ¨í„´ í•™ìŠµ ë° ì˜ˆì¸¡

### ğŸ’¡ ë§ì¶¤í˜• ì¡°ì–¸ ì‹œìŠ¤í…œ
- **ì¦‰ì‹œ ì‹¤í–‰ ì¡°ì–¸**: í˜¸í¡ë²•, ëª…ìƒ, ìš´ë™ ë“± ì¦‰ì‹œ ì ìš© ê°€ëŠ¥í•œ ë°©ë²•
- **ì¥ê¸° ê´€ë¦¬ ì „ëµ**: ê°œì¸ íŒ¨í„´ ê¸°ë°˜ ì˜ˆë°©ì  ê°ì • ê´€ë¦¬ ì „ëµ
- **ë‹¨ê³„ë³„ ê°€ì´ë“œ**: ì‹¤í–‰ ì²´í¬ë¦¬ìŠ¤íŠ¸ ë° íš¨ê³¼ ì¶”ì 

### ğŸ“Š ê°ì • íˆìŠ¤í† ë¦¬ ëŒ€ì‹œë³´ë“œ
- **íŠ¸ë Œë“œ ì‹œê°í™”**: ì¼/ì£¼/ì›”ë³„ ê°ì • ë³€í™” ì°¨íŠ¸
- **íŒ¨í„´ ë¶„ì„**: ê°ì • íŠ¸ë¦¬ê±° ë¶„ì„ ë° í†µê³„
- **ê°œì„  ì¶”ì **: ê°ì • ê´€ë¦¬ íš¨ê³¼ ì¸¡ì • ë° ì§„í–‰ë¥  í™•ì¸

## ğŸ›  ê¸°ìˆ  ìŠ¤íƒ

### Frontend & Framework
```
Next.js 14 (App Router)
React 18
TypeScript 5.0
Tailwind CSS 3.4
Framer Motion (ì• ë‹ˆë©”ì´ì…˜)
Radix UI (ì»´í¬ë„ŒíŠ¸)
React Hook Form + Zod (í¼ ê´€ë¦¬)
Zustand (í´ë¼ì´ì–¸íŠ¸ ìƒíƒœ ê´€ë¦¬)
```

### Backend & Database
```
Supabase (BaaS)
â”œâ”€â”€ PostgreSQL (ë°ì´í„°ë² ì´ìŠ¤)
â”œâ”€â”€ Auth (ì¸ì¦ ì‹œìŠ¤í…œ)
â”œâ”€â”€ Edge Functions (ì„œë²„ë¦¬ìŠ¤)
â”œâ”€â”€ Realtime (ì‹¤ì‹œê°„ êµ¬ë…)
â”œâ”€â”€ Storage (íŒŒì¼ ì €ì¥)
â””â”€â”€ Row Level Security (ë³´ì•ˆ)
```

### AI & Analytics
```
OpenAI GPT-4 API
Supabase Edge Functions (AI ë¡œì§)
Vercel Analytics
PostHog (ì‚¬ìš©ì ë¶„ì„)
Sentry (ì—ëŸ¬ ì¶”ì )
```

### DevOps & Deployment
```
Vercel (í˜¸ìŠ¤íŒ… & CI/CD)
GitHub Actions (ì¶”ê°€ ì›Œí¬í”Œë¡œìš°)
Supabase CLI (ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬)
ESLint + Prettier (ì½”ë“œ í’ˆì§ˆ)
```

### UI/UX Libraries
```
Chart.js / Recharts (ë°ì´í„° ì‹œê°í™”)
React Hot Toast (ì•Œë¦¼)
Lucide React (ì•„ì´ì½˜)
next-themes (ë‹¤í¬ëª¨ë“œ)
```

## ğŸ— ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```mermaid
graph TB
    A[Next.js App] --> B[Vercel Edge Network]
    B --> C[Next.js API Routes]
    C --> D[Supabase Client]
    
    D --> E[Supabase Auth]
    D --> F[PostgreSQL Database]
    D --> G[Supabase Storage]
    D --> H[Edge Functions]
    
    H --> I[OpenAI GPT-4 API]
    C --> J[PostHog Analytics]
    A --> K[Vercel Analytics]
    
    L[Real-time Subscriptions] --> D
    M[Row Level Security] --> F
```

## ğŸš€ ì„¤ì¹˜ ë° ì‹¤í–‰

### ì‚¬ì „ ìš”êµ¬ì‚¬í•­
- Node.js 18.17 ì´ìƒ
- npm, yarn, ë˜ëŠ” pnpm
- Git
- Supabase ê³„ì •

### 1. í”„ë¡œì íŠ¸ ì„¤ì •
```bash
# ì €ì¥ì†Œ í´ë¡ 
git clone https://github.com/your-org/emotion-wise.git
cd emotion-wise

# ì˜ì¡´ì„± ì„¤ì¹˜
npm install
# ë˜ëŠ”
yarn install
# ë˜ëŠ”
pnpm install
```

### 2. Supabase í”„ë¡œì íŠ¸ ì„¤ì •
```bash
# Supabase CLI ì„¤ì¹˜ (ì „ì—­)
npm install -g supabase

# Supabase ë¡œê·¸ì¸
supabase login

# ë¡œì»¬ ê°œë°œ í™˜ê²½ ì‹œì‘
supabase start

# ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì ìš©
supabase db reset
```

### 3. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
```bash
# .env.local íŒŒì¼ ìƒì„±
cp .env.example .env.local
```

`.env.local` íŒŒì¼ ì„¤ì •:
```env
# Supabase ì„¤ì •
NEXT_PUBLIC_SUPABASE_URL=your_supabase_project_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key

# OpenAI API
OPENAI_API_KEY=your_openai_api_key

# ë¶„ì„ ë„êµ¬
NEXT_PUBLIC_POSTHOG_KEY=your_posthog_key
NEXT_PUBLIC_POSTHOG_HOST=https://app.posthog.com

# Sentry (í”„ë¡œë•ì…˜)
SENTRY_DSN=your_sentry_dsn
```

### 4. ê°œë°œ ì„œë²„ ì‹¤í–‰
```bash
# ê°œë°œ ì„œë²„ ì‹œì‘
npm run dev
# ë˜ëŠ”
yarn dev
# ë˜ëŠ”
pnpm dev

# ë¸Œë¼ìš°ì €ì—ì„œ http://localhost:3000 ì ‘ì†
```

### 5. ë°ì´í„°ë² ì´ìŠ¤ ì‹œë“œ ë°ì´í„°
```bash
# ì‹œë“œ ë°ì´í„° ì‚½ì…
npm run db:seed

# ë˜ëŠ” Supabase Studioì—ì„œ ì§ì ‘ ê´€ë¦¬
# http://localhost:54323
```

## ğŸ“š API ë¬¸ì„œ

### Supabase í´ë¼ì´ì–¸íŠ¸ ì‚¬ìš©

#### ì¸ì¦
```typescript
// app/lib/supabase.ts
import { createClientComponentClient } from '@supabase/auth-helpers-nextjs'

const supabase = createClientComponentClient()

// íšŒì›ê°€ì…
const signUp = async (email: string, password: string, userData: any) => {
  const { data, error } = await supabase.auth.signUp({
    email,
    password,
    options: {
      data: {
        name: userData.name,
        age: userData.age,
        occupation: userData.occupation,
      }
    }
  })
  return { data, error }
}

// ë¡œê·¸ì¸
const signIn = async (email: string, password: string) => {
  const { data, error } = await supabase.auth.signInWithPassword({
    email,
    password,
  })
  return { data, error }
}
```

#### ê°ì • ê¸°ë¡ CRUD
```typescript
// ê°ì • ê¸°ë¡ ìƒì„±
const createEmotionRecord = async (emotionData: EmotionRecord) => {
  const { data, error } = await supabase
    .from('emotion_records')
    .insert({
      user_id: (await supabase.auth.getUser()).data.user?.id,
      situation: emotionData.situation,
      conversation_content: emotionData.conversation,
      emotions: emotionData.emotions,
      created_at: new Date().toISOString(),
    })
    .select()
    .single()
  
  return { data, error }
}

// ê°ì • ê¸°ë¡ ì¡°íšŒ
const getEmotionRecords = async (userId: string, limit = 20) => {
  const { data, error } = await supabase
    .from('emotion_records')
    .select(`
      *,
      emotion_analysis (
        primary_emotion,
        triggers,
        confidence_score,
        advice_recommendations
      )
    `)
    .eq('user_id', userId)
    .order('created_at', { ascending: false })
    .limit(limit)
  
  return { data, error }
}
```

### API Routes (Next.js)

#### AI ê°ì • ë¶„ì„
```typescript
// app/api/analyze-emotion/route.ts
import { NextRequest, NextResponse } from 'next/server'
import { createRouteHandlerClient } from '@supabase/auth-helpers-nextjs'
import { analyzeEmotionWithAI } from '@/lib/ai-service'

export async function POST(request: NextRequest) {
  const supabase = createRouteHandlerClient({ cookies })
  
  // ì¸ì¦ í™•ì¸
  const { data: { user }, error: authError } = await supabase.auth.getUser()
  if (authError || !user) {
    return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })
  }

  const { emotionRecordId, conversationContent, situationContext } = await request.json()

  try {
    // AI ë¶„ì„ ì‹¤í–‰
    const analysisResult = await analyzeEmotionWithAI({
      conversation: conversationContent,
      situation: situationContext,
      userId: user.id
    })

    // ë¶„ì„ ê²°ê³¼ ì €ì¥
    const { data, error } = await supabase
      .from('emotion_analysis')
      .insert({
        emotion_record_id: emotionRecordId,
        primary_emotion: analysisResult.primaryEmotion,
        triggers: analysisResult.triggers,
        confidence_score: analysisResult.confidence,
        advice_recommendations: analysisResult.advice,
        analysis_metadata: analysisResult.metadata
      })
      .select()
      .single()

    return NextResponse.json({ success: true, analysis: data })
  } catch (error) {
    console.error('AI ë¶„ì„ ì˜¤ë¥˜:', error)
    return NextResponse.json(
      { error: 'Analysis failed' }, 
      { status: 500 }
    )
  }
}
```

### Supabase Edge Functions

#### ê³ ê¸‰ AI ë¶„ì„ í•¨ìˆ˜
```typescript
// supabase/functions/advanced-emotion-analysis/index.ts
import { serve } from "https://deno.land/std@0.168.0/http/server.ts"
import { createClient } from 'https://esm.sh/@supabase/supabase-js@2'

const corsHeaders = {
  'Access-Control-Allow-Origin': '*',
  'Access-Control-Allow-Headers': 'authorization, x-client-info, apikey, content-type',
}

serve(async (req) => {
  if (req.method === 'OPTIONS') {
    return new Response('ok', { headers: corsHeaders })
  }

  try {
    const supabase = createClient(
      Deno.env.get('SUPABASE_URL') ?? '',
      Deno.env.get('SUPABASE_SERVICE_ROLE_KEY') ?? ''
    )

    const { conversation, userHistory, situationContext } = await req.json()

    // OpenAI API í˜¸ì¶œ
    const openAIResponse = await fetch('https://api.openai.com/v1/chat/completions', {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${Deno.env.get('OPENAI_API_KEY')}`,
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        model: 'gpt-4',
        messages: [
          {
            role: 'system',
            content: `ë‹¹ì‹ ì€ ê°ì • ë¶„ì„ ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ì‚¬ìš©ìì˜ ëŒ€í™” ë‚´ìš©ê³¼ ìƒí™©ì„ ë¶„ì„í•˜ì—¬ ê°ì • ìƒíƒœì™€ ì›ì¸ì„ íŒŒì•…í•˜ê³ , ë§ì¶¤í˜• ì¡°ì–¸ì„ ì œê³µí•˜ì„¸ìš”.`
          },
          {
            role: 'user',
            content: `ìƒí™©: ${JSON.stringify(situationContext)}\nëŒ€í™” ë‚´ìš©: ${conversation}\nì´ì „ íŒ¨í„´: ${JSON.stringify(userHistory)}`
          }
        ],
        max_tokens: 1000,
        temperature: 0.3,
      }),
    })

    const aiResult = await openAIResponse.json()
    const analysis = JSON.parse(aiResult.choices[0].message.content)

    return new Response(
      JSON.stringify({ success: true, analysis }),
      { 
        headers: { ...corsHeaders, 'Content-Type': 'application/json' },
        status: 200 
      }
    )
  } catch (error) {
    return new Response(
      JSON.stringify({ error: error.message }),
      { 
        headers: { ...corsHeaders, 'Content-Type': 'application/json' },
        status: 500 
      }
    )
  }
})
```

## ğŸ”§ ê°œë°œ ê°€ì´ë“œ

### í”„ë¡œì íŠ¸ êµ¬ì¡°
```
emotion-wise/
â”œâ”€â”€ app/                          # Next.js 14 App Router
â”‚   â”œâ”€â”€ (auth)/                  # ì¸ì¦ ê´€ë ¨ í˜ì´ì§€
â”‚   â”‚   â”œâ”€â”€ login/
â”‚   â”‚   â””â”€â”€ signup/
â”‚   â”œâ”€â”€ (dashboard)/             # ëŒ€ì‹œë³´ë“œ í˜ì´ì§€
â”‚   â”‚   â”œâ”€â”€ emotions/
â”‚   â”‚   â”œâ”€â”€ analysis/
â”‚   â”‚   â””â”€â”€ settings/
â”‚   â”œâ”€â”€ api/                     # API Routes
â”‚   â”‚   â”œâ”€â”€ analyze-emotion/
â”‚   â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â””â”€â”€ webhooks/
â”‚   â”œâ”€â”€ components/              # React ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ ui/                 # Radix UI ê¸°ë°˜ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ forms/              # í¼ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ charts/             # ì°¨íŠ¸ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â””â”€â”€ layout/             # ë ˆì´ì•„ì›ƒ ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ lib/                     # ìœ í‹¸ë¦¬í‹° ë° ì„¤ì •
â”‚   â”‚   â”œâ”€â”€ supabase.ts         # Supabase í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ ai-service.ts       # AI ì„œë¹„ìŠ¤ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ utils.ts            # ê³µí†µ ìœ í‹¸ë¦¬í‹°
â”‚   â”‚   â””â”€â”€ validations.ts      # Zod ìŠ¤í‚¤ë§ˆ
â”‚   â”œâ”€â”€ hooks/                   # ì»¤ìŠ¤í…€ í›…
â”‚   â”‚   â”œâ”€â”€ use-emotion-records.ts
â”‚   â”‚   â”œâ”€â”€ use-auth.ts
â”‚   â”‚   â””â”€â”€ use-analytics.ts
â”‚   â”œâ”€â”€ store/                   # Zustand ìŠ¤í† ì–´
â”‚   â”‚   â”œâ”€â”€ auth-store.ts
â”‚   â”‚   â”œâ”€â”€ emotion-store.ts
â”‚   â”‚   â””â”€â”€ ui-store.ts
â”‚   â”œâ”€â”€ types/                   # TypeScript íƒ€ì… ì •ì˜
â”‚   â”‚   â”œâ”€â”€ database.ts
â”‚   â”‚   â”œâ”€â”€ emotion.ts
â”‚   â”‚   â””â”€â”€ api.ts
â”‚   â”œâ”€â”€ globals.css             # ì „ì—­ ìŠ¤íƒ€ì¼
â”‚   â”œâ”€â”€ layout.tsx              # ë£¨íŠ¸ ë ˆì´ì•„ì›ƒ
â”‚   â””â”€â”€ page.tsx                # í™ˆí˜ì´ì§€
â”œâ”€â”€ supabase/
â”‚   â”œâ”€â”€ functions/              # Edge Functions
â”‚   â”œâ”€â”€ migrations/             # ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜
â”‚   â”œâ”€â”€ seed.sql               # ì‹œë“œ ë°ì´í„°
â”‚   â””â”€â”€ config.toml            # Supabase ì„¤ì •
â”œâ”€â”€ public/                     # ì •ì  íŒŒì¼
â”œâ”€â”€ docs/                       # ë¬¸ì„œ
â”œâ”€â”€ .env.example               # í™˜ê²½ ë³€ìˆ˜ ì˜ˆì‹œ
â”œâ”€â”€ next.config.js             # Next.js ì„¤ì •
â”œâ”€â”€ tailwind.config.js         # Tailwind ì„¤ì •
â”œâ”€â”€ tsconfig.json              # TypeScript ì„¤ì •
â””â”€â”€ package.json
```

### ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ
```sql
-- supabase/migrations/001_initial_schema.sql

-- ì‚¬ìš©ì í”„ë¡œí•„ í™•ì¥
CREATE TABLE public.user_profiles (
  id UUID REFERENCES auth.users ON DELETE CASCADE,
  name TEXT NOT NULL,
  age INTEGER,
  occupation TEXT,
  timezone TEXT DEFAULT 'Asia/Seoul',
  notification_preferences JSONB DEFAULT '{}',
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  PRIMARY KEY (id)
);

-- ê°ì • ê¸°ë¡ í…Œì´ë¸”
CREATE TABLE public.emotion_records (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  user_id UUID REFERENCES auth.users(id) ON DELETE CASCADE,
  situation JSONB NOT NULL, -- {datetime, location, people, type}
  conversation_content TEXT NOT NULL,
  emotions JSONB NOT NULL, -- [{type, intensity}]
  audio_file_url TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- AI ë¶„ì„ ê²°ê³¼ í…Œì´ë¸”
CREATE TABLE public.emotion_analysis (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  emotion_record_id UUID REFERENCES emotion_records(id) ON DELETE CASCADE,
  primary_emotion TEXT NOT NULL,
  triggers TEXT[] NOT NULL,
  confidence_score DECIMAL(3,2) NOT NULL,
  advice_recommendations JSONB NOT NULL,
  analysis_metadata JSONB DEFAULT '{}',
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- ì¡°ì–¸ í”¼ë“œë°± í…Œì´ë¸”
CREATE TABLE public.advice_feedback (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  emotion_analysis_id UUID REFERENCES emotion_analysis(id) ON DELETE CASCADE,
  advice_id TEXT NOT NULL,
  effectiveness_rating INTEGER CHECK (effectiveness_rating >= 1 AND effectiveness_rating <= 10),
  execution_status TEXT CHECK (execution_status IN ('completed', 'partial', 'not_executed')),
  user_notes TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- RLS ì •ì±… ì„¤ì •
ALTER TABLE public.user_profiles ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.emotion_records ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.emotion_analysis ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.advice_feedback ENABLE ROW LEVEL SECURITY;

-- ì‚¬ìš©ìëŠ” ìì‹ ì˜ ë°ì´í„°ë§Œ ì ‘ê·¼ ê°€ëŠ¥
CREATE POLICY "Users can view own profile" ON user_profiles FOR SELECT USING (auth.uid() = id);
CREATE POLICY "Users can update own profile" ON user_profiles FOR UPDATE USING (auth.uid() = id);
CREATE POLICY "Users can view own emotion records" ON emotion_records FOR SELECT USING (auth.uid() = user_id);
CREATE POLICY "Users can insert own emotion records" ON emotion_records FOR INSERT WITH CHECK (auth.uid() = user_id);
-- ë¶„ì„ ë° í”¼ë“œë°± ì •ì±…ë„ ë™ì¼í•˜ê²Œ ì ìš©
```

### íƒ€ì… ì •ì˜
```typescript
// app/types/database.ts
export interface Database {
  public: {
    Tables: {
      user_profiles: {
        Row: {
          id: string
          name: string
          age: number | null
          occupation: string | null
          timezone: string
          notification_preferences: any
          created_at: string
          updated_at: string
        }
        Insert: {
          id: string
          name: string
          age?: number | null
          occupation?: string | null
          timezone?: string
          notification_preferences?: any
        }
        Update: {
          name?: string
          age?: number | null
          occupation?: string | null
          timezone?: string
          notification_preferences?: any
          updated_at?: string
        }
      }
      emotion_records: {
        Row: {
          id: string
          user_id: string
          situation: any
          conversation_content: string
          emotions: any
          audio_file_url: string | null
          created_at: string
          updated_at: string
        }
        Insert: {
          user_id: string
          situation: any
          conversation_content: string
          emotions: any
          audio_file_url?: string | null
        }
        Update: {
          situation?: any
          conversation_content?: string
          emotions?: any
          audio_file_url?: string | null
          updated_at?: string
        }
      }
      // ... ë‹¤ë¥¸ í…Œì´ë¸”ë“¤
    }
  }
}
```

### ì»¤ìŠ¤í…€ í›… ì˜ˆì‹œ
```typescript
// app/hooks/use-emotion-records.ts
import { useState, useEffect } from 'react'
import { createClientComponentClient } from '@supabase/auth-helpers-nextjs'
import { Database } from '@/types/database'

type EmotionRecord = Database['public']['Tables']['emotion_records']['Row']

export function useEmotionRecords() {
  const [records, setRecords] = useState<EmotionRecord[]>([])
  const [loading, setLoading] = useState(true)
  const [error, setError] = useState<string | null>(null)
  
  const supabase = createClientComponentClient<Database>()

  const fetchRecords = async () => {
    try {
      setLoading(true)
      const { data, error } = await supabase
        .from('emotion_records')
        .select(`
          *,
          emotion_analysis (
            primary_emotion,
            triggers,
            confidence_score,
            advice_recommendations
          )
        `)
        .order('created_at', { ascending: false })

      if (error) throw error
      setRecords(data || [])
    } catch (err) {
      setError(err instanceof Error ? err.message : 'Unknown error')
    } finally {
      setLoading(false)
    }
  }

  const createRecord = async (recordData: any) => {
    try {
      const { data, error } = await supabase
        .from('emotion_records')
        .insert(recordData)
        .select()
        .single()

      if (error) throw error
      
      // ì‹¤ì‹œê°„ìœ¼ë¡œ ëª©ë¡ ì—…ë°ì´íŠ¸
      setRecords(prev => [data, ...prev])
      return { data, error: null }
    } catch (err) {
      return { data: null, error: err instanceof Error ? err.message : 'Unknown error' }
    }
  }

  useEffect(() => {
    fetchRecords()

    // ì‹¤ì‹œê°„ êµ¬ë… ì„¤ì •
    const subscription = supabase
      .channel('emotion_records')
      .on('postgres_changes', {
        event: '*',
        schema: 'public',
        table: 'emotion_records'
      }, fetchRecords)
      .subscribe()

    return () => {
      subscription.unsubscribe()
    }
  }, [])

  return {
    records,
    loading,
    error,
    createRecord,
    refetch: fetchRecords
  }
}
```

### í…ŒìŠ¤íŠ¸ ì„¤ì •
```typescript
// __tests__/setup.ts
import { beforeAll, afterAll, beforeEach } from 'vitest'
import { createClient } from '@supabase/supabase-js'

const supabase = createClient(
  process.env.SUPABASE_URL!,
  process.env.SUPABASE_SERVICE_ROLE_KEY!
)

beforeAll(async () => {
  // í…ŒìŠ¤íŠ¸ ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”
})

afterAll(async () => {
  // í…ŒìŠ¤íŠ¸ ë°ì´í„° ì •ë¦¬
})

beforeEach(async () => {
  // ê° í…ŒìŠ¤íŠ¸ ì „ ë°ì´í„° ë¦¬ì…‹
})
```

## ğŸš¢ ë°°í¬

### Vercel ë°°í¬ ì„¤ì •
```javascript
// next.config.js
/** @type {import('next').NextConfig} */
const nextConfig = {
  experimental: {
    serverActions: true,
  },
  images: {
    domains: ['your-supabase-project.supabase.co'],
  },
  async headers() {
    return [
      {
        source: '/api/:path*',
        headers: [
          { key: 'Access-Control-Allow-Origin', value: '*' },
          { key: 'Access-Control-Allow-Methods', value: 'GET,OPTIONS,PATCH,DELETE,POST,PUT' },
          { key: 'Access-Control-Allow-Headers', value: 'X-CSRF-Token, X-Requested-With, Accept, Accept-Version, Content-Length, Content-MD5, Content-Type, Date, X-Api-Version' },
        ],
      },
    ]
  },
}

module.exports = nextConfig
```

### í™˜ê²½ë³„ ë°°í¬
```bash
# ê°œë°œ í™˜ê²½ ë°°í¬
vercel --prod --env NEXT_PUBLIC_SUPABASE_URL=dev_url

# í”„ë¡œë•ì…˜ ë°°í¬
git push origin main  # Vercelì´ ìë™ ë°°í¬

# Supabase ë§ˆì´ê·¸ë ˆì´ì…˜ ì ìš©
supabase db push --linked
```

### GitHub Actions ì›Œí¬í”Œë¡œìš°
```yaml
# .github/workflows/ci.yml
name: CI/CD Pipeline

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'
      
      - run: npm ci
      - run: npm run lint
      - run: npm run type-check
      - run: npm run test
      
      - name: Run E2E tests
        run: npm run test:e2e
        env:
          SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
          SUPABASE_ANON_KEY: ${{ secrets.SUPABASE_ANON_KEY }}

  deploy:
    needs: test
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    steps:
      - uses: actions/checkout@v4
      - uses: amondnet/vercel-action@v25
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          vercel-args: '--prod'
          vercel-org-id: ${{ secrets.ORG_ID }}
          vercel-project-id: ${{ secrets.PROJECT_ID }}
```

## ğŸ¤ ê¸°ì—¬í•˜ê¸°

### ê¸°ì—¬ ë°©ë²•
1. ì´ìŠˆ í™•ì¸ ë˜ëŠ” ìƒˆ ì´ìŠˆ ìƒì„±
2. Fork í›„ ê¸°ëŠ¥ ë¸Œëœì¹˜ ìƒì„±
3. ì½”ë“œ ì‘ì„± ë° í…ŒìŠ¤íŠ¸
4. Pull Request ìƒì„±
5. ì½”ë“œ ë¦¬ë·° ë° ë¨¸ì§€

### ê°œë°œ ëª…ë ¹ì–´
```bash
# ê°œë°œ ì„œë²„ ì‹¤í–‰
npm run dev

# ë¦°íŒ… ë° í¬ë§·íŒ…
npm run lint
npm run format

# íƒ€ì… ì²´í¬
npm run type-check

# í…ŒìŠ¤íŠ¸ ì‹¤í–‰
npm run test
npm run test:watch
npm run test:e2e

# ë¹Œë“œ
npm run build

# Supabase ê´€ë ¨
npm run db:reset      # ë¡œì»¬ DB ë¦¬ì…‹
npm run db:seed       # ì‹œë“œ ë°ì´í„° ì‚½ì…
npm run db:generate   # íƒ€ì… ìƒì„±
npm run db:push       # ìŠ¤í‚¤ë§ˆ í‘¸ì‹œ
```

### ì½”ë”© ì»¨ë²¤ì…˜
```typescript
// ì»´í¬ë„ŒíŠ¸ ì˜ˆì‹œ
import { useState } from 'react'
import { createClientComponentClient } from '@supabase/auth-helpers-nextjs'

interface EmotionInputProps {
  onSubmit: (emotion: EmotionData) => void
  initialData?: EmotionData
}

export function EmotionInput({ onSubmit, initialData }: EmotionInputProps) {
  const [emotion, setEmotion] = useState<EmotionData>(initialData || {})
  const supabase = createClientComponentClient()

  const handleSubmit = async (data: EmotionData) => {
    // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
    onSubmit(data)
  }

  return (
    <form onSubmit={handleSubmit}>
      {/* ì»´í¬ë„ŒíŠ¸ ë‚´ìš© */}
    </form>
  )
}
```

## ğŸ“Š ì„±ëŠ¥ ì§€í‘œ

### ëª©í‘œ KPI
- **Core Web Vitals**: LCP < 2.5s, FID < 100ms, CLS < 0.1
- **API ì‘ë‹µ**: Next.js API Routes < 200ms
- **AI ë¶„ì„**: Edge Functions < 3ì´ˆ
- **ê°€ìš©ì„±**: Vercel 99.99% ì—…íƒ€ì„

### 